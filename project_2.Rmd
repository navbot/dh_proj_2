---
title: "Project 2"
authors: "Navdeep Singh, Shreya Khobragade, Samridhi Hooda"
output: html_notebook
---

```{r load_libraries}
#loading all the necessary libraries
library(gutenbergr)
library(tidytext)
library(tidyverse)
library(readtext)
```

```{r gutenberg_fitzgerald_works}
#finding texts by Fitzgerald on gutenberg
fitzgerald_text <- gutenberg_works(author == "Fitzgerald, F. Scott (Francis Scott)")
fitzgerald_text <- fitzgerald_text[-c(2,3), ]
```

```{r gutenberg_fitzgerald_download}
#downloading all the texts found
fitzgerald_download <- fitzgerald_text %>% 
                      gutenberg_download(meta_fields = c("title", "author"))
```
```{r import_Fitzgerald_books}
The_Great_Gatsby <- read_delim("The Great Gatsby_Fitzgerald, F. Scott (Francis Scott).txt", 
    delim = ".", quote = "\\\"", escape_double = FALSE)
The_Great_Gatsby <- The_Great_Gatsby %>% mutate(author = "Fitzgerald, F. Scott (Francis Scott)", .after = text) %>% mutate(title = "The Great Gatsby", .before = author)

Tender_is_the_Night <- read_delim("Tender is the Night_Fitzgerald, F. Scott (Francis Scott).txt", 
    delim = ".", quote = "\\\"", escape_double = FALSE)
Tender_is_the_Night <- Tender_is_the_Night %>% mutate(author = "Fitzgerald, F. Scott (Francis Scott)", .after = text) %>% mutate(title = "Tender is the Night", .before = author)
```

```{r create_Fitzgerald_corpus}
fitzgerald_download$gutenberg_id <- NULL
fitzgerald_corpus <- bind_rows(fitzgerald_download, The_Great_Gatsby, Tender_is_the_Night)
```


```{r import_Hemingway_books}

The_Sun_Also_Rises_Hemingway_Ernest <- read_delim("The Sun Also Rises_Hemingway, Ernest.txt", 
    delim = "\t", quote = "\\\"", escape_double = FALSE, 
    trim_ws = TRUE)
The_Sun_Also_Rises_Hemingway_Ernest <- The_Sun_Also_Rises_Hemingway_Ernest %>% mutate(author = "Hemingway, Earnest", .after = text) %>% mutate(title = "The Sun Also Rises", .before = author)

The_Old_Man_and_the_Sea_Hemingway_Ernest <- read_delim("The Old Man and the Sea_Hemingway, Ernest.txt", 
    delim = ".", quote = "\\\"", escape_double = FALSE)
The_Old_Man_and_the_Sea_Hemingway_Ernest <- The_Old_Man_and_the_Sea_Hemingway_Ernest %>% mutate(author = "Hemingway, Earnest", .after = text) %>% mutate(title = "The Old Man and the Sea", .before = author)

For_Whom_the_Bell_Tolls_Hemingway_Ernest <- read_delim("For Whom the Bell Tolls_Hemingway, Ernest.txt", 
    delim = ".", quote = "\\\"", escape_double = FALSE)
For_Whom_the_Bell_Tolls_Hemingway_Ernest <- For_Whom_the_Bell_Tolls_Hemingway_Ernest %>% mutate(author = "Hemingway, Earnest", .after = text) %>% mutate(title = "For Whom The Bell Tolls", .before = author)

A_Farewell_to_Arms_Hemingway_Ernest <- read_delim("A Farewell to Arms_Hemingway, Ernest.txt", 
    delim = ".", quote = "\\\"", escape_double = FALSE)
A_Farewell_to_Arms_Hemingway_Ernest <- A_Farewell_to_Arms_Hemingway_Ernest %>% mutate(author = "Hemingway, Earnest", .after = text) %>% mutate(title = "A Farewell to Arms", .before = author)

hemingway_corpus <- bind_rows(The_Sun_Also_Rises_Hemingway_Ernest,The_Old_Man_and_the_Sea_Hemingway_Ernest,For_Whom_the_Bell_Tolls_Hemingway_Ernest,A_Farewell_to_Arms_Hemingway_Ernest)
```

```{r tidy_hemingway}
#breaking up texts into words
tidy_hemingway <- hemingway_corpus %>% unnest_tokens(word, text) %>% anti_join(stop_words)
```

```{r tidy_fitzgerald}
#breaking up texts into words
tidy_fitzgerald <- fitzgerald_corpus %>% unnest_tokens(word, text) %>% anti_join(stop_words)
```

```{r adding_female_words}
#collection of words representing a female
female_words <- c("she", "her", "woman", "girl", "aunt", "mother", "sister", "wife", "lady")

female_df <- tibble(word = female_words, female = TRUE)
```

```{r hemingway_tagged}
hemingway_tagged <- tidy_hemingway %>% left_join(female_df)
```

```{r fitzgerald_tagged}
fitzgerald_tagged <- tidy_fitzgerald %>% left_join(female_df)
```

```{r fitzgerald_count}
#counting how often female words appeared
#table shows each text and the respective percentage
fitzgerald_table <- fitzgerald_tagged %>% group_by(title) %>% count(female) %>% mutate(percent = n/sum(n)*100)

```

```{r hemingway_count}
#counting how often female words appeared
#table shows each text and the respective percentage
hemingway_table <- hemingway_tagged %>% group_by(title) %>% count(female) %>% mutate(percent = n/sum(n)*100)

```

```{r combined_result}
#table showing two authors and their respective usage of female words
author_table <- bind_rows(fitzgerald_tagged, hemingway_tagged)
author_table <- author_table %>% group_by(author) %>% count(female) %>% mutate(percent = n/sum(n)*100) %>% drop_na(female)

#table showing all texts and their respective usage of female words
combined_table <- bind_rows(hemingway_table, fitzgerald_table) %>% drop_na(female)
```
```{r frequency_distribution}
hemingway_wordcount <- tidy_hemingway %>% count(word, sort = TRUE) %>% mutate(frequency = (n/sum(n)), .after = n)
fitzgerald_wordcount <- tidy_fitzgerald %>% count(word, sort = TRUE) %>% mutate(frequency = (n/sum(n)), .after = n)

```

```{r exporting_tables}
save(author_table, file = "saved_data.rda")
```

```{r wildcard}
puretext <- bind_rows(tidy_hemingway[, 3], tidy_fitzgerald[, 3])
purestring <- unlist(puretext)
sad_1 <- paste(unique(str_subset(purestring, "^anger|^angr|^disgust|^contempt|^revuls|^envy|^envi|^jealous|^exaspera|^frustra|^aggrava|^agitat|^annoy|^grouch|^grump|^irrita|^bitter|^dislike|^feroci|^fury|^furi|^hate|^hostil|^loath|^outrage|^rage|^rag|^resent|^scorn|^spite|^venge|^wrath|^torment|^fear|^horr|^alarm|^fright|^hyster|^mortifi|^panic|^shock|^terror|^nervous|^anxi|^apprehen|^distress|^dread|^tense|^uneasi|^uneasy|^worr|^joy|^cheer|^amuse|^bliss|^delight|^ecsta|^elati|^enjoy|^euphor|^gaiety|^glad|^glee|^happi|^jolli|^jolly|^jovial|^jubil|^satisf|^content|^pleasur|^enthrall|^raptur|^eager|^hope|^optimis|^pride|^proud|^triumph|^relie|^zest|^enthusias|^excit|^exhilara|^thrill|^zeal|^love|^ador|^affec|^attrac|^care|^cari|^compassion|^fond|^like|^liking|^sentiment|^tender|^long|^arous|^desire|^infatuat|^lust|^passion|^sad|^disappoint|^dismay|^displeasur|^alien|^defeat|^deject|^embarrass|^homesick|^humiliat|^insecur|^isola|^insult|^lonel|^neglect|^reject|^depress|^despair|^gloom|^glum|^grie|^hopeless|^melancholi|^miser|^sorrow|^unhappi|^woe|^shame|^guilt|^regret|^remorse|^suffer|^agon|^anguish|^hurt|^pity|^piti|^sympath|^surprise|^amaze|^astonish")), collapse = ' ')
```